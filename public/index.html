<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Your Vault</title>
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <div class="sidebar">
    <h1>Vault Index</h1>
    <div class="file-list" id="file-list">
      Loading notesâ€¦
    </div>
  </div>

  <div class="content">
    <div class="welcome">
      <h2>Welcome</h2>
      <p>
        Pick a note to view it.
      </p>
    </div>
  </div>

  <script>
    async function loadFiles() {
      const listEl = document.getElementById("file-list");

      try {
        const res = await fetch("/api/notes");
        const files = await res.json();

        listEl.innerHTML = "";

        const indexListElement = document.createElement("li");
        const indexA = document.createElement("a");

        indexA.href = "/";
        indexA.textContent = "Home";

        indexListElement.appendChild(indexA);
        listEl.appendChild(indexListElement);
        files.forEach(full => {
          const short = full
            .replace(/\.html$/, "");
          const li = document.createElement("li");
          const a = document.createElement("a");
          a.href = "/notes/" + full;
          a.textContent = short;

          li.appendChild(a);
          listEl.appendChild(li);
        });
      } catch (e) {
        listEl.textContent = "Failed to load notes.";
      }
    }

    loadFiles();
  </script>
</body>

</html>
